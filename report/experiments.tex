%roughly 2-3 pages
%\begin{itemize}
%\item any details about experiments (dataset sizes, parameter selection, etc)
%\item results
%\item analysis (discussion of results/visualizations/findings/etc)
%\end{itemize}

The experiments have been run on a dataset consisting of $9.728$ labeled documents. Different parameters may influence the accuracy of the classifier.These are $\alpha$, the Dirichlet parameter for $\theta$, $\beta$, the Dirichlet parameter for $\varphi$, the number of topics to be extracted from the dataset and the number of iterations for Gibbs sampling. 
For validation, k-fold cross-validation has been used with $k=5$ (as described in section \ref{sec:fold}), to ensure an unbiased test. Table \ref{table:genre_sizes} shows the number of documents in the dataset for each genre.

\begin{table}[htp!]
\begin{center}
\scalebox{0.7}{
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|} 
\hline
Genre & Reggae & Latin & Holiday & Stage \& Screen & Electronic & Children's & Country & Jazz & Vocal & Easy Listening & New age \\
\hline
\# Documents & 65 & 67 & 11& 121 & 330 & 60 & 679 & 138 & 259 & 28 & 21 \\
\hline
\hline
Genre & R\&B & Avant-Garde & Pop/Rock & Folk & Rap & International & Blues & Comedy/Spoken & Religious & Classical & Total\\
\hline
\# Documents& 785 & 6 & 5470 & 129 & 720 & 186 & 101 & 35 & 470 & 47 & 9728\\
\hline
\end{tabular}}
\caption{Number of documents per genre}
\label{table:genre_sizes}
\end{center}
\end{table}


\subsection{Cross-validation}\label{sec:fold}
Cross-validation is a validation technique to asses how the results of the models will generalize. In this research a stratified 5-fold cross-validation is implemented. In 5-fold cross-validation, the dataset is split into 5 equal size subsets and the algorithm is performed 5 times (or folds) in which one of the 5 subsets is used as validation data. Each experiment is thus run 5 times where the training set entails 80\% of the total data set and the validation set entails 20\% of the total dataset. Due to the variation in population for each genre in the dataset, a stratified sampling of training and validation set for the subsets is used. This sampling technique preserves the percentage of samples for each class in all subsets.


\begin{figure}[htp!]
\begin{mdframed}
        \centering
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/holiday.png}
                \caption{Genre Holiday}
                \label{fig:topicdist_holiday}
        \end{subfigure}%
        ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/religious.png}
                \caption{Genre Religious}
                \label{fig:topicdist_religious}
        \end{subfigure}
        ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/pop-rock.png}
                \caption{Genre Pop/Rock}
                \label{fig:topicdist_poprock}
        \end{subfigure}
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/reggae.png}
                \caption{Genre Reggae}
                \label{fig:topicdist_reggae}
        \end{subfigure}%
        ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/electronic.png}
                \caption{Genre Electronic}
                \label{fig:topicdist_electronic}
        \end{subfigure}
        ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.3\textwidth}
                \includegraphics[width=\textwidth]{bar_charts/international.png}
                \caption{Genre International}
                \label{fig:topicdist_international}
        \end{subfigure}
        \caption{Topic distibution for different genres}\label{fig:topicdist}
\end{mdframed}
\end{figure}



\subsection{Results}
Figure \ref{fig:topicdist} presents genre profiles for different genres. Each profile is created by summing topic counts for every document in the genre, and averaging these. These profiles are strongly dominated by one or two topics for certain genres, like \textit{Holiday}, \textit{Religious} and \textit{Reggae}, but more evenly distributed for others, like \textit{Electronic} or \textit{Pop/Rock}. This is not surprising, as \textit{Holiday} and \textit{Religious} are genres named after the themes of their songs, and not their musical structure. Moreover, \textit{Pop/Rock} contains music styles ranging from pop music to brutal death metal, resulting in a genre profile that covers a wide range of topics. Results of the classification using the extended LDA and original LDA model can be found in table \ref{tab:poprock100}. The classifiers have scores of around 50\%. However, at close inspection of the classifications, it showed that the classifiers almost always predicted the genre Pop/Rock. Since more than half of the dataset consists of data labeled with \textit{Pop/Rock}, it is unsurprising that the classifier didn't work too well. 
\input{elises_big_run}


Consequently, the same experiment was re-run, leaving out the data labeled \textit{Pop/Rock}. As a result, the dataset consisted of $4.258$ documents. The results of running extended and original LDA without \textit{Pop/Rock} documents can be found in table \ref{tab:difflda}. These results show that extended LDA outperforms original LDA. Moreover, the most distinctive topics were \textit{R\&B} and \textit{Rap}. Higher results were expected for \textit{Holiday} and \textit{Religious} and \textit{Reggae}, due to their distinctive genre profiles. However, the size of \textit{Holiday} and \textit{Reggae} was relatively small (11 and 65 documents). However, \textit{Religious} is a rather large part of the dataset. Further analysis showed that most documents belonging to the genre \textit{Religious} were predicted to be \textit{Country}, which is a larger subset of the dataset. Since \textit{Country} is a genre associated with the conservative American South, it might share a lot of themes with \textit{Religious} (allusions to God and Heaven, for example). 

The results of different parameter settings for $\alpha$ and $\beta$ can be found in table \ref{tab:onetable}. The best F1-score is achieved using $\alpha=0.5$ and $\beta-0.1$. This might be because a high $\alpha$-value ensures overlapping topic distributions, resulting in a large mixture of different topics over genres. A low $\beta$-value creates less overlap in words over topics, creating high-information topics that are more distinctive.
\input{results_nonpoprock_50topics_a0.1_b0.1}
\input{onetable}\label{tab:onetable}
\input{table_origlda_50topics_a0.1_b_0.1_nonpoprock_prf}
\input{elises_small_run}

It can be seen that the extension of LDA puts out more sensible topics than regular LDA: for example, after 20 iterations, the top words of the top topic of the reggae genre are \verb|yeah|, \verb|get|, \verb|got|, \verb|right|, \verb|man|, \verb|like|, \verb|little|, \verb|time|, \verb|say| and \verb|hey| using regular LDA, and \verb|mi|, \verb|fight|, \verb|police|, \verb|gonna|, \verb|say|, \verb|jah|, \verb|whatcha|, \verb|dem|, \verb|ya|, \verb|yuh|, \verb|burnin| and \verb|ah| using the extension of LDA. This results in a more effective classifier, the differences between the F1 scores of regular LDA and extended LDA can be seen in table \ref{tab:extvsoriglda} \\
Furthermore, the results show that genres containing a lot of lyrics, like holiday, rap and religious tend to have a higher F1 score than genres containing not that many lyrics, like classical and electronic. The cause of this lies in two reasons: not only do these genres have more lyrics, but their lyrics are also more distinct for the genre. 




\begin{figure}
\begin{mdframed}
cause leader sun nigga bastard push verse \\
end account high mountain ballin trash yall \\
pen tears writing instrumental gucci like chorus \\
rule best clean legit line curtains way heroin \\
proven nothin yo find 1 aint oh \\
ride every rising gambino
\caption{Song generated in genre \textit{rap} with $\alpha=\beta=0.7$, 20 topics and 30 iterations}
 \end{mdframed}
\label{text:rap_song}
\end{figure}